{% extends 'base_content.html' %}
{% load bootstrap_pagination %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col-12">
      <a class="btn btn-primary" style="float: right;" href="{% url 'create_club' %}">Create Club</a>
      <h1>Clubs</h1>
      <br>
      {% bootstrap_paginate page_obj range=6 previous_label="Previous" next_label="Next" show_first_last="true" %}
      <table class="table">
        <tr>
          <th></th>
          <th>Club</th>
          <th>Leader</th>
          <th>Theme</th>
          <th>Members</th>
          <th></th>
        </tr>
        {% for club in clubs %}
          <tr>
            <td><a href="{% url 'show_club' club.id %}">
              <img src="{{ user.mini_gravatar }}" alt="Gravatar of {{ club.name }}" class="rounded-circle" >
            </a></td>
            <td><a href="{% url 'show_club' club.id %}">{{ club.name }}</a></td>
            <td>{{ club.leader }}</td>
            <td>{{ club.theme }}</td>
            <td>{{ club.members.count }}/{{ club.maximum_members }}</td>
            <td>
                {% if user in club.members.all %}
                  <form action="{% url 'join_club' user.id club.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-secondary">Leave</button>
                  </form>
                {% else %}
                  {% if user in club.applicants.all %}
                    <form action="{% url 'join_club' user.id club.id %}" method="post">
                      {% csrf_token %}
                        <button type="submit" class="btn btn-primary">Request sent</button>
                    </form>
                  {% else %}
                    <form action="{% url 'join_club' user.id club.id %}" method="post">
                      {% csrf_token %}
                        <button type="submit" class="btn btn-primary">Join</button>
                    </form>
                  {% endif %}
                {% endif %}
            </td>
          </tr>
        {% endfor %}
      </table>
      {% bootstrap_paginate page_obj range=6 previous_label="Previous" next_label="Next" show_first_last="true" %}
    </div>
  </div>
</div>

{% endblock %}
