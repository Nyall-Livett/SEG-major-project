{% extends 'base_content.html' %}
{% block content %}
{% load humanize %}

<div class="container-fluid" style="padding:0px 48px;">

  <div class="row">

    <!-- Left -->
    <div class="col-xl-2 min" style="background-color:red">

    </div>

    <!-- Middle -->
    <div class="col-xl-8 min">

      <!-- Moment header -->
      <div class="moments-header">
        <div>
          <h3 style="color:#878787">Moments</h3>

        </div>
        <div style="margin-left: 24px;">
          <h5 style="margin-bottom: 0px; color:cornflowerblue">“Some moments are nice, some are nicer, some are even worth writing about.”</h5> <small style="color:#767676">― Charles Bukowski</small>
        </div>
      </div>

      <!-- Share a moment -->
      <div class="row flex-center" style="margin-top:28px;">
        <div class="col">
          <form id="moment-form" onsubmit="submitForm(event, this)" action="{% url 'create_moment' %}" method="post">
            {% csrf_token %}
            {% for field in form %}
            <div class="mb-3">
              <label for="moment_id" class="form-label" style="color:#43a1f3;">Share a moment with your followers</label>
              <input type="{{ field.field.widget.input_type }}" class="form-control" id="moment-body" placeholder="Say something..." autocomplete="off">
            </div>
            {% endfor %}
          </form>
        </div>
      </div>

      <!-- View moments -->
      {% for moment in object_list %}
        <div class="row flex-center">
          <div class="col">
            <div class="container-fluid notification-card" style="padding-left: 8px;">
              <div class="row">
                <div class="notification-image" style="height:100px; width:100px">
                  <img src="{{ user.mini_gravatar }}" alt="Gravatar of {{ user.username }}" class="rounded-circle">
                </div>
                <div class="col" style="padding:10px;">
                  <div class="row">
                    <a href="#">{{moment.user.username}}</a>
                  </div>
                  <div class="row">
                    <p>{{moment.body}}</p>
                  </div>
                </div>
              </div>
              <div class="information">
                <small style="color:#a8a8a8">{{moment.created_on|naturaltime}}</small>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Right -->
    <div class="col-xl-2 min" style="background-color:green">

    </div>
  </div>

</div>

{% endblock %}
{% block javascript %}

<script type="text/javascript">

  $(document).ready(function() {

  })

  const submitForm = (event, form) => {
      event.preventDefault()
      body = $('#moment-body').val()
      $.ajax({
        type: 'POST',
        data: {
          csrfmiddlewaretoken: '{{ csrf_token }}',
          moment_body: JSON.stringify(body)
        },
        url: {% url 'create_moment' %},
        dataType: "JSON"
      }).done((data) => {
        debugger
      })

  }

</script>

{% endblock %}
